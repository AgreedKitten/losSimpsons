<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="referrer" content="no-referrer">
    <title>Catálogo Simpsons</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/estilos.css">
</head>
<body>
    <div id="app" class="container py-4">
        <div class="bg-header p-3 mb-4 text-center rounded">
            <h2>Catálogo de Personajes</h2>
        </div>
        <div class="progress mb-4" style="height: 30px;">
            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" v-bind:style="{ width: porcentajeProgreso + '%' }">
                Mostrando {{ personajesFiltrados.length }} de {{ personajes.length }}
            </div>
        </div>
        <div class="row mb-4 bg-white p-3 rounded border border-dark shadow-sm">
            <div class="col-md-6">
                <label class="form-label fw-bold">Filtrar por Género:</label>
                <select class="form-select border-dark" v-model="categoriaSeleccionada">
                    <option value="">Todos</option>
                    <option v-for="cat in categoriasUnicas" v-bind:value="cat" v-text="cat"></option>
                </select>
            </div>
            <div class="col-md-6 d-flex align-items-end">
                <div class="alert alert-warning border-dark w-100 mb-0 mt-3 mt-md-0 text-center text-dark fw-bold">
                    Suma de edades válidas: <span>{{ calculoEstadistico }}</span>
                </div>
            </div>
        </div>
        <div v-if="personajesFiltrados.length === 0" class="alert alert-light border-dark text-center fw-bold shadow-sm">
            Cargando personajes...
        </div>
        <div class="row" v-show="personajesFiltrados.length > 0">
            <div class="col-md-4 col-lg-3 mb-4" v-for="personaje in personajesFiltrados" :key="personaje.id">
                <div class="card h-100 shadow">
                    <img v-bind:src="generarImagen(personaje)" class="card-img-top p-3" style="height: 250px; object-fit: contain;" alt="Personaje">
                    <div class="card-body d-flex flex-column text-center bg-light rounded-bottom">
                        <h5 class="card-title fw-bold" v-text="personaje.name"></h5>
                        <p class="mt-auto mb-3" v-html="'<strong>Ocupación: </strong>' + (personaje.occupation || 'Desconocida')"></p>
                        <button class="btn btn-simpson w-100 shadow-sm" v-on:click="abrirModal(personaje)">Ver Detalle</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="modalPersonaje" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header bg-header">
                        <h5 class="modal-title" v-text="personajeSeleccionado.name"></h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body text-center bg-light">
                        <img v-bind:src="generarImagen(personajeSeleccionado)" class="img-fluid mb-3 drop-shadow" style="max-height: 250px;">
                        <br>
                        <span class="badge bg-warning text-dark border border-dark fs-6 mb-3" v-text="personajeSeleccionado.status"></span>
                        <p class="text-start p-2 border bg-white rounded" v-text="'Edad: ' + (personajeSeleccionado.age || 'Desconocida')"></p>
                    </div>
                    <div class="modal-footer bg-light border-top-0">
                        <button type="button" class="btn btn-dark" data-bs-dismiss="modal">Cerrar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/vue3.js"></script>
    <script src="js/axios.min.js"></script>
    <script src="js/funciones.js"></script>
</body>
</html>